@model Model.Order
@{
	ViewBag.Title = "Index";
	Layout = "~/Views/Shared/_Layout.cshtml";
	var items = (List<Model.CartItem>)Session["CartSession"];
	double? TotalMoney = 0;
	double? currentTotal = 0;
	double? price;
}

<div class="space-custom"></div>
<!-- breadcrumb start -->
<div class="breadcrumb-area">
	<div class="container">
		<ol class="breadcrumb">
			<li><a href="#"><i class="fa fa-home"></i></a></li>
			<li><a href="#">Shop</a></li>
			<li class="active">Checkout</li>
		</ol>
	</div>
</div>
@if (Session["User"] == null)
{
<div class="alert alert-warning">
	<p style="text-align: center">Mời bạn đăng nhập để có thể đặt hàng</p>
	<a class="btn btn-primary" href="@Url.Action("Index","Login")">Đăng nhập</a>
</div>
	
	
}
else if (Session["CartSession"] == null)
{
	<div class="alert alert-warning">
		<p style="text-align: center">Giỏ hàng trống! Mời bạn chọn sản phẩm</p>
	</div>
	
}
else
{

	<!-- breadcrumb end -->
	<!-- coupon-area start -->
	<div class="coupon-area">
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<div class="coupon-accordion">
						<!-- ACCORDION START -->
						<h3>Returning customer? <span id="showlogin">Click here to login</span></h3>
						<div id="checkout-login" class="coupon-content">
							<div class="coupon-info">
								<p class="coupon-text">Quisque gravida turpis sit amet nulla posuere lacinia. Cras sed est sit amet ipsum luctus.</p>
								<form action="#" method="post">
									<p class="form-row-first">
										<label>Username or email <span class="required">*</span></label>
										<input type="text" />
									</p>
									<p class="form-row-last">
										<label>Password  <span class="required">*</span></label>
										<input type="text" />
									</p>
									<p class="form-row">
										<input type="submit" value="Login" />
										<label>
											<input type="checkbox" />
											Remember me
										</label>
									</p>
									<p class="lost-password">
										<a href="#">Lost your password?</a>
									</p>
								</form>
							</div>
						</div>
						<!-- ACCORDION END -->
						<!-- ACCORDION START -->
						<h3>Have a coupon? <span id="showcoupon">Click here to enter your code</span></h3>
						<div id="checkout_coupon" class="coupon-checkout-content">
							<div class="coupon-info">
								<form action="#">
									<p class="checkout-coupon">
										<input type="text" placeholder="Coupon code" />
										<input type="submit" value="Apply Coupon" />
									</p>
								</form>
							</div>
						</div>
						<!-- ACCORDION END -->
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- coupon-area end -->
	<!-- checkout-area start -->
	<div class="checkout-area">
		<div class="container">
			<div class="row">
				@using (Html.BeginForm()) 
				{
					<div class="col-lg-6 col-md-6">
						<div class="checkbox-form">
							<h3>Thông tin giao nhận hàng</h3>
							<div class="row">
								<input hidden name="User_ID" value="@ViewBag.User.UserId" />
								<div class="col-md-12">
									<div class="checkout-form-list">
										<label> Tên người nhận</label>
										<input type="text" name="Name" value="@ViewBag.User.FullName" placeholder="" />
										@Html.ValidationMessageFor(model => model.Name, "", new { @class = "text-danger" })

									</div>
								</div>
								<div class="col-md-12">
									<div class="checkout-form-list">
										<label>Email</label>
										<input type="text" name="Email" value="@ViewBag.User.Email" placeholder="" />
										@Html.ValidationMessageFor(model => model.Email, "", new { @class = "text-danger" })

									</div>
								</div>
								<div class="col-md-12">
									<div class="checkout-form-list">
										<label>Số điện thoại</label>
										<input type="text" name="Phone" value="@ViewBag.User.Phone" placeholder="" />
										@Html.ValidationMessageFor(model => model.Phone, "", new { @class = "text-danger" })
									</div>
								</div>
								<div class="col-md-12">
									<div class="checkout-form-list">
										<label>Địa chỉ <span class="required">*</span></label>
										<input type="text" name="Address" value="@ViewBag.User.Address" placeholder="Street address" />
										@Html.ValidationMessageFor(model => model.Address, "", new { @class = "text-danger" })

									</div>
								</div>

								
							</div>

						</div>
					</div>
					<div class="col-lg-6 col-md-6">
						<div class="your-order">
							<h3>Chi tiết đơn hàng</h3>
							<div class="your-order-table table-responsive">
								<table>
									<thead>
										<tr>
											<th class="product-name">Tên sản phẩm</th>
											<th class="product-name">Đơn giá</th>
											<th class="product-total">Hình ảnh</th>
											<th class="product-total">Tổng tiền</th>
										</tr>
									</thead>
									<tbody>

										@foreach (var item in items)
										{
											price = (item.Product.Price >  item.Product.Sale_Price) ? item.Product.Sale_Price : item.Product.Price;
											TotalMoney += (price * item.Quantity);
											currentTotal=(price * item.Quantity);
											
										<tr class="cart_item">
											<td class="product-name">
												@item.Product.Name <strong class="product-quantity"> × @item.Quantity</strong>
											</td>
											<td class="product-name">
												@price
											</td>
											<td class="product-name">
												<img style="width: 100px" src="@item.Product.Images" alt="Alternate Text" />
											</td>
											<td class="product-total">
												<span class="amount"> @currentTotal VND</span>
											</td>
										</tr>
										}
									</tbody>
									<tfoot>
										
										<tr class="order-total">
											<th>Tổng tiền đơn hàng</th>
											<td>
												<strong><span class="amount">@TotalMoney VND</span></strong>
											</td>
										</tr>
									</tfoot>
								</table>
							</div>
							<div class="payment-method">
								<div class="payment-accordion">
									<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
										<div class="panel panel-default">
											<div class="panel-heading" role="tab" id="headingOne">
												<h4 class="panel-title">
													<a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
														Direct Bank Transfer
													</a>
												</h4>
											</div>
											<div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
												<div class="panel-body">
													<p>Make your payment directly into our bank account. Please use your Order ID as the payment reference. Your order won’t be shipped until the funds have cleared in our account.</p>
												</div>
											</div>
										</div>
										<div class="panel panel-default">
											<div class="panel-heading" role="tab" id="headingTwo">
												<h4 class="panel-title">
													<a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
														Cheque Payment
													</a>
												</h4>
											</div>
											<div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
												<div class="panel-body">
													<p>Please send your cheque to Store Name, Store Street, Store Town, Store State / County, Store Postcode.</p>
												</div>
											</div>
										</div>
										<div class="panel panel-default">
											<div class="panel-heading" role="tab" id="headingThree">
												<h4 class="panel-title">
													<a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
														PayPal
													</a>
												</h4>
											</div>
											<div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
												<div class="panel-body">
													<p>Pay via PayPal; you can pay with your credit card if you don’t have a PayPal account.</p>
												</div>
											</div>
										</div>
									</div>
									<div class="order-button-payment">
										<input type="submit" value="Đặt hàng" />
									</div>
								</div>
							</div>
						</div>
					</div>
				}
			</div>
		</div>
	</div>
	<!-- checkout-area end -->
	<!-- service-area start -->

	<!-- service-area end -->
	
	<!-- footer end -->
	<!-- Modal -->
	
	<!-- Modal end -->
}

<!-- header end -->
